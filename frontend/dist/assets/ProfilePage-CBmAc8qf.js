import{u as v,r as n,j as e,b as k}from"./index-DUtD6WRW.js";import{u as w}from"./userService-BA24lqGw.js";const L=()=>{const{user:r,updateUserProfile:f}=v(),[l,c]=n.useState(!1),[s,g]=n.useState(null),[m,o]=n.useState(!1),[d,x]=n.useState({username:"",email:"",preferredRole:"",avatar:""}),[h,u]=n.useState(""),[p,j]=n.useState("");n.useEffect(()=>{(async()=>{if(r)try{c(!0);const t=await w.getUserStats(r.id);g(t)}catch(t){console.error("Failed to fetch user stats:",t)}finally{c(!1)}})()},[r]),n.useEffect(()=>{r&&x({username:r.username,email:r.email,preferredRole:r.preferredRole||"",avatar:r.avatar||""})},[r]);const i=a=>{const{name:t,value:N}=a.target;x(y=>({...y,[t]:N}))},b=async a=>{a.preventDefault(),u(""),j("");try{c(!0),await f(d),j("Profile updated successfully"),o(!1)}catch{u("Failed to update profile. Please try again.")}finally{c(!1)}};return l&&!r?e.jsx(k,{message:"Loading Profile"}):r?e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-display font-bold mb-8",children:"Your Profile"}),e.jsx("div",{className:"card p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-primary-900 flex items-center justify-center text-3xl font-bold",children:r.avatar?e.jsx("img",{src:r.avatar,alt:r.username,className:"w-full h-full rounded-full object-cover"}):r.username.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:r.username}),e.jsx("p",{className:"text-gray-400 mb-2",children:r.preferredRole||"No preferred role"}),e.jsxs("p",{className:"text-gray-500",children:["Member since ",new Date(r.createdAt).toLocaleDateString()]}),!m&&e.jsx("button",{onClick:()=>o(!0),className:"btn-primary mt-4",children:"Edit Profile"})]})]})}),m&&e.jsxs("div",{className:"card p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Profile"}),h&&e.jsx("div",{className:"bg-secondary-900 border border-secondary-800 text-secondary-200 px-4 py-3 rounded mb-4",children:h}),p&&e.jsx("div",{className:"bg-green-900 border border-green-800 text-green-200 px-4 py-3 rounded mb-4",children:p}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-gray-300 mb-2",children:"Username"}),e.jsx("input",{type:"text",id:"username",name:"username",className:"input w-full",value:d.username,onChange:i,disabled:l,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-300 mb-2",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",className:"input w-full",value:d.email,onChange:i,disabled:l,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"preferredRole",className:"block text-gray-300 mb-2",children:"Preferred Role"}),e.jsxs("select",{id:"preferredRole",name:"preferredRole",className:"input w-full",value:d.preferredRole,onChange:i,disabled:l,children:[e.jsx("option",{value:"",children:"Select a role (optional)"}),e.jsx("option",{value:"Techno Monk",children:"Techno Monk"}),e.jsx("option",{value:"Shadow Broker",children:"Shadow Broker"}),e.jsx("option",{value:"Chrono Diplomat",children:"Chrono Diplomat"}),e.jsx("option",{value:"Bio-Smith",children:"Bio-Smith"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"avatar",className:"block text-gray-300 mb-2",children:"Avatar URL"}),e.jsx("input",{type:"text",id:"avatar",name:"avatar",className:"input w-full",value:d.avatar,onChange:i,disabled:l,placeholder:"https://example.com/avatar.jpg"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Leave empty to use initials"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"btn-secondary",disabled:l,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:l,children:l?"Saving...":"Save Changes"})]})]})]}),e.jsxs("div",{className:"card p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Game Statistics"}),l&&!s?e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-400",children:"Loading stats..."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-dark-700 rounded-lg text-center",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Games Played"}),e.jsx("p",{className:"text-2xl font-semibold",children:(s==null?void 0:s.totalGamesPlayed)||0})]}),e.jsxs("div",{className:"p-4 bg-dark-700 rounded-lg text-center",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Wins"}),e.jsx("p",{className:"text-2xl font-semibold",children:(s==null?void 0:s.totalWins)||0})]}),e.jsxs("div",{className:"p-4 bg-dark-700 rounded-lg text-center",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Karma Score"}),e.jsx("p",{className:"text-2xl font-semibold",children:(s==null?void 0:s.karmaScore)||0})]}),e.jsxs("div",{className:"p-4 bg-dark-700 rounded-lg text-center",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Win Rate"}),e.jsxs("p",{className:"text-2xl font-semibold",children:[s!=null&&s.totalGamesPlayed?Math.round(s.totalWins/s.totalGamesPlayed*100):0,"%"]})]})]}),(s==null?void 0:s.techTreeProgress)&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Tech Tree Progress"}),e.jsx("div",{className:"space-y-3",children:Object.entries(s.techTreeProgress).map(([a,t])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-300",children:a}),e.jsxs("span",{className:"text-gray-400",children:["Level ",t.current,"/",t.max]})]}),e.jsx("div",{className:"w-full bg-dark-700 rounded-full h-2",children:e.jsx("div",{className:"bg-tech-500 h-2 rounded-full",style:{width:`${t.current/t.max*100}%`}})})]},a))})]}),(s==null?void 0:s.recentGames)&&s.recentGames.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Recent Games"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-dark-600",children:[e.jsx("th",{className:"pb-2 font-medium",children:"Game"}),e.jsx("th",{className:"pb-2 font-medium",children:"Date"}),e.jsx("th",{className:"pb-2 font-medium",children:"Result"}),e.jsx("th",{className:"pb-2 font-medium",children:"Karma"})]})}),e.jsx("tbody",{children:s.recentGames.map(a=>e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("td",{className:"py-3",children:a.name}),e.jsx("td",{className:"py-3 text-gray-400",children:new Date(a.completedAt).toLocaleDateString()}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${a.result==="win"?"bg-green-900 text-green-400":"bg-secondary-900 text-secondary-400"}`,children:a.result==="win"?"Victory":"Defeat"})}),e.jsx("td",{className:"py-3",children:e.jsxs("span",{className:a.karmaGained>=0?"text-green-500":"text-red-500",children:[a.karmaGained>0?"+":"",a.karmaGained]})})]},a.id))})]})})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Achievements"}),l&&!s?e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-400",children:"Loading achievements..."})}):s!=null&&s.achievements&&s.achievements.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.achievements.map(a=>e.jsxs("div",{className:"p-4 bg-dark-700 rounded-lg flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${a.unlocked?"bg-primary-900 text-primary-400":"bg-dark-800 text-gray-500"}`,children:a.unlocked?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-semibold ${a.unlocked?"text-white":"text-gray-500"}`,children:a.name}),e.jsx("p",{className:`text-sm ${a.unlocked?"text-gray-400":"text-gray-600"}`,children:a.description}),a.unlocked&&e.jsxs("p",{className:"text-xs text-primary-500 mt-1",children:["Unlocked on ",new Date(a.unlockedAt).toLocaleDateString()]})]})]},a.id))}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-400",children:"No achievements unlocked yet."}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Play more games to earn achievements!"})]})]})]}):e.jsxs("div",{className:"card p-6 text-center",children:[e.jsx("h2",{className:"text-2xl font-display font-bold mb-4",children:"Profile Not Available"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Please log in to view your profile."})]})};export{L as default};
