import{c as R,u as I,r as n,a as E,j as e,b as T}from"./index-DUtD6WRW.js";import{u as F}from"./useGame-s5k70gI4.js";const A=()=>{const{gameId:t}=R(),{user:r}=I(),{currentGame:s,fetchGameById:o,joinGame:f,leaveGame:u,startGame:N,loading:v,error:c}=F(),[m,h]=n.useState(!1),[x,g]=n.useState(!1),[p,b]=n.useState(!1),[l,k]=n.useState(""),d=E(),w=[{id:"techno-monk",name:"Techno Monk",description:"Masters of technology and spirituality"},{id:"shadow-broker",name:"Shadow Broker",description:"Information dealers with vast networks"},{id:"chrono-diplomat",name:"Chrono Diplomat",description:"Negotiators across timelines"},{id:"bio-smith",name:"Bio-Smith",description:"Genetic engineers and biological architects"}];n.useEffect(()=>{t&&o(t)},[t,o]);const y=s==null?void 0:s.players.some(a=>a.id===(r==null?void 0:r.id)),j=(s==null?void 0:s.creator.id)===(r==null?void 0:r.id),S=j&&(s==null?void 0:s.players.length)>=2,C=async()=>{if(!(!t||!l)){h(!0);try{await f(t,l)}catch(a){console.error("Failed to join game:",a)}finally{h(!1)}}},G=async()=>{if(t){g(!0);try{await u(t),d("/dashboard")}catch(a){console.error("Failed to leave game:",a)}finally{g(!1)}}},L=async()=>{if(t){b(!0);try{await N(t),d(`/games/${t}/board`)}catch(a){console.error("Failed to start game:",a)}finally{b(!1)}}};return v&&!s?e.jsx(T,{message:"Loading Game Lobby"}):s?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold",children:s.name}),e.jsxs("p",{className:"text-gray-400 mt-1",children:["Created by ",s.creator.username]})]}),e.jsx("div",{className:"flex gap-3",children:y?e.jsxs(e.Fragment,{children:[j&&e.jsx("button",{onClick:L,className:"btn-primary",disabled:!S||p,children:p?"Starting...":"Start Game"}),e.jsx("button",{onClick:G,className:"btn-secondary",disabled:x,children:x?"Leaving...":"Leave Game"})]}):e.jsx("button",{onClick:C,className:"btn-primary",disabled:m||!l||s.players.length>=s.maxPlayers,children:m?"Joining...":"Join Game"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6",children:[e.jsxs("div",{className:"bg-dark-700 p-4 rounded-lg",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Status"}),e.jsx("p",{className:"text-lg font-semibold",children:s.status==="waiting"?"Waiting for Players":s.status})]}),e.jsxs("div",{className:"bg-dark-700 p-4 rounded-lg",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Players"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.players.length,"/",s.maxPlayers]})]}),e.jsxs("div",{className:"bg-dark-700 p-4 rounded-lg",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Starting Era"}),e.jsx("p",{className:"text-lg font-semibold",children:s.startingEra})]})]}),s.description&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-gray-300",children:s.description})]})]}),c&&e.jsx("div",{className:"bg-secondary-900 border border-secondary-800 text-secondary-200 px-4 py-3 rounded",children:c}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-2xl font-display font-semibold mb-4",children:"Players"}),e.jsxs("div",{className:"space-y-4",children:[s.players.map(a=>e.jsxs("div",{className:"flex items-center p-3 bg-dark-700 rounded-lg",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary-900 flex items-center justify-center mr-4",children:e.jsx("span",{className:"text-lg font-medium",children:a.username.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:a.username}),e.jsx("p",{className:"text-sm text-gray-400",children:a.role})]}),a.id===s.creator.id&&e.jsx("span",{className:"ml-auto text-xs px-2 py-1 bg-primary-900 text-primary-500 border border-primary-700 rounded-full",children:"Host"})]},a.id)),Array.from({length:s.maxPlayers-s.players.length}).map((a,i)=>e.jsxs("div",{className:"flex items-center p-3 bg-dark-800 rounded-lg border border-dashed border-dark-600",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-dark-700 flex items-center justify-center mr-4",children:e.jsx("span",{className:"text-gray-500",children:"?"})}),e.jsx("p",{className:"text-gray-500",children:"Waiting for player..."})]},`empty-${i}`))]})]}),!y&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-2xl font-display font-semibold mb-4",children:"Select Your Role"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map(a=>{const i=s.players.some(P=>P.role.toLowerCase()===a.name.toLowerCase());return e.jsxs("div",{className:`
                    p-4 rounded-lg border-2 cursor-pointer transition-all
                    ${l===a.id?"border-primary-500 bg-primary-900 bg-opacity-20":"border-dark-600 bg-dark-700 hover:border-dark-500"}
                    ${i?"opacity-50 cursor-not-allowed":""}
                  `,onClick:()=>!i&&k(a.id),children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"font-semibold",children:a.name}),i&&e.jsx("span",{className:"text-xs px-2 py-1 bg-dark-800 text-gray-400 rounded-full",children:"Taken"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:a.description})]},a.id)})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-2xl font-display font-semibold mb-4",children:"Game Rules"}),e.jsxs("div",{className:"space-y-4 text-gray-300",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ChronoCore: Path of Realities"})," is a strategic board game set in a multiverse where players navigate different timelines and make ethical choices that impact the game world."]}),e.jsx("p",{children:"Each player takes on a unique role with special abilities and must collaborate and compete to achieve their objectives while maintaining the stability of the multiverse."}),e.jsx("p",{children:"The game is played in turns, with each player taking actions such as moving between realms, gathering resources, completing quests, and making decisions that affect their karma score."}),e.jsx("p",{children:"The winner is determined by a combination of objectives completed, realms controlled, and karma score at the end of the game."})]})]})]}):e.jsxs("div",{className:"card p-6 text-center",children:[e.jsx("h2",{className:"text-2xl font-display font-bold mb-4",children:"Game Not Found"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"The game you're looking for doesn't exist or has been removed."}),e.jsx("button",{onClick:()=>d("/dashboard"),className:"btn-primary",children:"Return to Dashboard"})]})};export{A as default};
