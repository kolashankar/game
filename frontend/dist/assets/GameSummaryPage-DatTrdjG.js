import{c as N,u as p,r as x,a as y,j as e,b as f,L as h}from"./index-DUtD6WRW.js";import{u}from"./useGame-s5k70gI4.js";const S=()=>{const{gameId:d}=N(),{user:t}=p(),{fetchGameById:c,loading:b,error:n}=u(),[a,j]=x.useState(null),g=y();if(x.useEffect(()=>{(async()=>{if(d)try{const r=await c(d);j(r)}catch(r){console.error("Failed to load game:",r)}})()},[d,c]),b&&!a)return e.jsx(f,{message:"Loading Game Summary"});if(!a)return e.jsxs("div",{className:"card p-6 text-center",children:[e.jsx("h2",{className:"text-2xl font-display font-bold mb-4",children:"Game Not Found"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"The game you're looking for doesn't exist or has been removed."}),e.jsx("button",{onClick:()=>g("/dashboard"),className:"btn-primary",children:"Return to Dashboard"})]});const l=a.players.find(s=>s.id===a.winnerId),m=(l==null?void 0:l.id)===(t==null?void 0:t.id),i=a.players.find(s=>s.id===(t==null?void 0:t.id));return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold",children:a.name}),e.jsxs("p",{className:"text-gray-400 mt-1",children:["Completed on ",new Date(a.completedAt).toLocaleDateString()]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsx(h,{to:"/dashboard",className:"btn-secondary",children:"Back to Dashboard"})})]})}),n&&e.jsx("div",{className:"bg-secondary-900 border border-secondary-800 text-secondary-200 px-4 py-3 rounded",children:n}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-2xl font-display font-semibold mb-6",children:"Game Result"}),e.jsxs("div",{className:`p-6 rounded-lg text-center mb-8 ${m?"bg-green-900 bg-opacity-20 border border-green-700":"bg-secondary-900 bg-opacity-20 border border-secondary-700"}`,children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:m?"Victory!":"Game Over"}),e.jsx("p",{className:"text-lg",children:l?`${l.username} won the game as ${l.role}`:"The game ended in a draw"}),i&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-gray-300",children:["Your final karma score: ",e.jsx("span",{className:"font-semibold",children:i.karmaScore})]}),e.jsxs("p",{className:"text-gray-300",children:["Tech level achieved: ",e.jsx("span",{className:"font-semibold",children:i.techLevel})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Player Rankings"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-dark-600",children:[e.jsx("th",{className:"pb-2 font-medium",children:"Rank"}),e.jsx("th",{className:"pb-2 font-medium",children:"Player"}),e.jsx("th",{className:"pb-2 font-medium",children:"Role"}),e.jsx("th",{className:"pb-2 font-medium text-right",children:"Karma"}),e.jsx("th",{className:"pb-2 font-medium text-right",children:"Tech Level"}),e.jsx("th",{className:"pb-2 font-medium text-right",children:"Realms"})]})}),e.jsx("tbody",{children:a.players.sort((s,r)=>r.karmaScore-s.karmaScore).map((s,r)=>{var o;return e.jsxs("tr",{className:`border-b border-dark-700 ${s.id===(t==null?void 0:t.id)?"bg-dark-800 bg-opacity-50":""}`,children:[e.jsx("td",{className:"py-3 font-medium",children:r+1}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full flex items-center justify-center",style:{backgroundColor:s.color||"#4B5563"},children:e.jsx("span",{className:"text-sm font-medium",children:s.username.charAt(0).toUpperCase()})}),e.jsxs("span",{className:s.id===(l==null?void 0:l.id)?"font-semibold":"",children:[s.username,s.id===(t==null?void 0:t.id)&&e.jsx("span",{className:"text-xs text-gray-400 ml-1",children:"(You)"})]})]})}),e.jsx("td",{className:"py-3 text-gray-300",children:s.role}),e.jsx("td",{className:"py-3 text-right font-medium",children:s.karmaScore}),e.jsx("td",{className:"py-3 text-right",children:s.techLevel}),e.jsx("td",{className:"py-3 text-right",children:((o=s.realms)==null?void 0:o.length)||0})]},s.id)})})]})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-2xl font-display font-semibold mb-6",children:"Game Statistics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-dark-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Game Duration"}),e.jsxs("p",{className:"text-2xl",children:[a.totalTurns," Turns"]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[Math.floor((new Date(a.completedAt).getTime()-new Date(a.startedAt).getTime())/(1e3*60))," minutes"]})]}),e.jsxs("div",{className:"bg-dark-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Timeline Stability"}),e.jsx("div",{className:"w-full bg-dark-800 rounded-full h-4 mb-2",children:e.jsx("div",{className:`h-4 rounded-full ${a.finalStability>70?"bg-green-500":a.finalStability>40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${a.finalStability}%`}})}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Final stability: ",a.finalStability,"%"]})]}),e.jsxs("div",{className:"bg-dark-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Ethical Decisions"}),e.jsx("p",{className:"text-2xl",children:a.totalDecisions||0}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Decisions made across all players"})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-2xl font-display font-semibold mb-6",children:"Key Moments"}),a.keyEvents&&a.keyEvents.length>0?e.jsx("div",{className:"relative pl-8 border-l-2 border-dark-600 space-y-8",children:a.keyEvents.map((s,r)=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-10 w-5 h-5 rounded-full bg-primary-900 border-2 border-primary-700"}),e.jsxs("div",{className:"mb-1 text-gray-400 text-sm",children:["Turn ",s.turn]}),e.jsx("h3",{className:"text-lg font-semibold mb-1",children:s.title}),e.jsx("p",{className:"text-gray-300",children:s.description}),s.player&&e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[s.player.username," â€¢ ",new Date(s.timestamp).toLocaleTimeString()]})]},r))}):e.jsx("p",{className:"text-gray-400 text-center py-4",children:"No key events recorded for this game."})]}),e.jsx("div",{className:"text-center py-6",children:e.jsx(h,{to:"/dashboard",className:"btn-primary px-8 py-3",children:"Play Another Game"})})]})};export{S as default};
